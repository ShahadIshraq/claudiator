#!/bin/bash
set -e

STAGED_SWIFT=$(git diff --cached --name-only --diff-filter=ACM | grep '\.swift$' || true)

if [ -z "$STAGED_SWIFT" ]; then
  exit 0
fi

echo "Running SwiftFormat on staged files..."
echo "$STAGED_SWIFT" | xargs swiftformat --config ios/.swiftformat 2>/dev/null || true

echo "Running SwiftLint on staged files..."
echo "$STAGED_SWIFT" | xargs swiftlint lint --strict --config ios/.swiftlint.yml --quiet

echo "$STAGED_SWIFT" | xargs git add
